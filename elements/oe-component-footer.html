<!--
Â©2015-2016 EdgeVerve Systems Limited (a fully owned Infosys subsidiary), Bangalore, India. All Rights Reserved.
-->
<link rel="import" href="../oe-component-redux-store.html">
<link rel="import" href="oe-component-list.html">
<dom-module id="oe-component-footer">
    <style>
        :host{
            display: flex;
        }
    </style>
    <template>
        <oe-component-list id="componentLister" template-list="{{templateList}}" on-page-selected="pageSelectedHandle" class="flex"></oe-component-list>
        <paper-icon-button hidden=[[!showActions]] icon="save" on-tap="_save"></paper-icon-button>
        <paper-icon-button hidden=[[!showActions]] icon="undo" disabled="[[_disableUndo(stackIndex)]]" on-tap="_undo"></paper-icon-button>
        <paper-icon-button hidden=[[!showActions]] icon="redo" disabled="[[_disableRedo(stackIndex)]]" on-tap="_redo"></paper-icon-button>
    </template>
    <script>
        Polymer({
            is: 'oe-component-footer',
            properties: {
                templateList: {
                    type: Array,
                    statePath: 'templateList'
                },
                componentStack: {
                    type: Array,
                    statePath: 'componentStack'
                },
                workingComponent: {
                    type: Object,
                    statePath: 'currComponent',
                    observer:'_currComponentLoaded'
                },
                stackIndex: {
                    type: Number,
                    statePath: 'stackIndex'
                }
            },
            behaviors: [OEUtils.AjaxBehavior, OEUtils.HTMLHelper,ComponentReduxBehavior],
            listeners: {
                'update-template-list':'_updateTemplateList'
            },
            actions:{
                updateStackIndex:function(index){return {type:'UPDATE_STACKINDEX',payload:index} },
                updateTemplateList:function(list){return {type:'UPDATE_TEMPLATES',payload:list} }
            },
            _currComponentLoaded:function(){
                this.set('showActions',(this.workingComponent && this.workingComponent.id));
            },
            _save: function () {
                this.$.componentLister.updateComponent(this.workingComponent);
            },
            _undo: function () {
                this.dispatch('updateStackIndex', this.stackIndex - 1);
            },
            _redo: function () {
                this.dispatch('updateStackIndex', this.stackIndex + 1);
            },
            _disableUndo: function (stackIndex) {
                return stackIndex === 0;
            },
            _disableRedo: function (stackIndex) {
                return stackIndex === (this.componentStack.length - 1);
            },
            _updateTemplateList:function(e){
                this.dispatch('updateTemplateList', e.detail);
            }
        });
    </script>
</dom-module>